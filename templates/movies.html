<!-- templates/movies.html -->
{% extends "base.html" %}

{% block content %}
    <h2>ðŸŽ¥ Movie for {{ user.name }}</h2>


    <!-- form to add new movie via title and add all details automatically with API -->
    <h3>ðŸŽ¬ Add a Movie by title</h3>
    <p> (add details automatically) </p>
        <form method="POST" action="{{ url_for('add_movie_omdb', user_id=user.id) }}">
            <label for="title">Movie Title:</label>
            <input type="text" name="title" required>
            <button type="submit">Fetch from OMDb</button>
        </form>

    <!-- List movies -->
    <h2>User's Movies</h2>
    <ul>
        {% for movie in movies %}
        <li>
            <div class="movie-card">
                <div class="movie-info">
                    <h2>{{ movie.title }}</h2>

                    <!-- Update form beside title -->
                    <form method="POST" action="{{ url_for('update_movie', user_id=user.id, movie_id=movie.id) }}" class="inline-form">
                        <input type="text" name="title" value="{{ movie.title }}" required>
                        <button type="submit">Update</button>
                    </form>

                    <p><strong>Year:</strong> {{ movie.publication_year or "N/A" }}</p>
                    <p><strong>Genre:</strong> {{ movie.genre or "Unknown" }}</p>
                    <p><strong>Rating:</strong> {{ movie.rating or "Not Rated" }}</p>

                    {% if movie.director and movie.director != "Unknown" %}
                        <p><strong>Director:</strong> {{ movie.director }}</p>
                    {% endif %}

                    {% if movie.runtime and movie.runtime != "N/A" %}
                        <p><strong>Runtime:</strong> {{ movie.runtime }}</p>
                    {% endif %}

                    <!-- Delete button at the bottom -->
                    <form method="POST" action="{{ url_for('delete_movie', user_id=user.id, movie_id=movie.id) }}">
                        <button class="delete-button" type="submit">Delete</button>
                    </form>
                </div>

                <!-- Poster image on the right -->
                {% if movie.poster_url %}
                    <div class="poster-container">
                        <img src="{{ movie.poster_url }}" alt="Movie Poster">
                    </div>
                {% endif %}
            </div>
        </li>
        {% else %}
            <li>No movies found.</li>
        {% endfor %}
    </ul>

    <!-- Form to add a new movie manually -->
    <h2>Add a New Movie manually</h2>
    <p> (add all details manually) </p>
    <form method="POST" action="{{ url_for('add_movie', user_id=user.id) }}">
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" required>

        <label for="genre">Genre:</label>
        <input type="text" id="genre" name="genre">

        <label for="year">Year:</label>
        <input type="number" id="year" name="publication_year">

        <label for="rating">Rating:</label>
        <input type="number" step="0.1" id="rating" name="rating">

        <button type="submit">Add Movie</button>
    </form>

{% endblock %}
